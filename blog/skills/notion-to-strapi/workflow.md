# Notion 到 Strapi 轉換工作流程

## 完整流程圖

```
┌─────────────────┐
│  Notion 文章    │
│  (提供 URL)     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 使用 Notion MCP │
│ 獲取頁面內容   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 下載圖片到本地 │
│ (public/assets) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 根據規格格式化 │
│ SEO 最佳化      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 生成 JSON 檔案 │
│ blog/docs/      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 建立 Strapi    │
│ 文章 (GraphQL) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 觸發 Webhook   │
│ 重新生成網站   │
└─────────────────┘
```

## 核心步驟說明

### 1. 獲取 Notion 內容
使用 Notion MCP 工具獲取指定頁面的標題、內容和圖片 URL。

### 2. 下載圖片到本地
自動將文章中的圖片下載到 `public/assets/` 目錄，並生成檔名對照表。

### 3. 格式化文章內容
根據 BLOG_PRD 規格書進行 SEO 最佳化：
- 生成最佳化的標題、副標題和描述
- 將 Notion 圖片 URL 替換為本地路徑
- 確保文章結構完整（引言、主體、結論）

### 4. 生成 JSON 檔案
建立符合 Strapi 格式的 JSON 檔案，儲存於 `blog/docs/{articleId}.json`。

### 5. 建立 Strapi 文章
透過 GraphQL API 將文章建立到 Strapi CMS。

### 6. 觸發網站重新生成
呼叫 Vercel Webhook 自動重新生成部落格網站。

## 常見問題排除

### Notion MCP 連線錯誤
- 檢查 MCP 設定和認證狀態
- 確保 Notion 頁面可訪問

### Strapi API 錯誤
- 檢查 `.env` 檔案中的環境變數
- 確認 API Token 有效性

### 圖片下載失敗
- Notion 圖片 URL 可能已過期
- 檢查網路連線和權限設定

## 技術架構

- **前端整合**：Notion MCP + Cursor
- **圖片處理**：Node.js 腳本自動化下載
- **內容格式化**：基於 BLOG_PRD 規格書
- **後端整合**：Strapi GraphQL API
- **部署觸發**：Vercel Webhook API